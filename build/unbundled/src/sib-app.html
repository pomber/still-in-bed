<html><head><link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-styles/color.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../bower_components/app-storage/app-localstorage/app-localstorage-document.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="sib-sun.html">
<link rel="import" href="sib-cloud.html">

</head><body><dom-module id="sib-app">
  <template>
    <style include="iron-flex iron-flex-alignment">
      :host {
        display: block;
        background-color: var(--paper-blue-300);
      }

      .sky {
        height: 250px; 
        position: relative;
        margin-bottom: 50px;
      }

      sib-sun {
        position: absolute;
        top: 10%;
        left: 5%;
        z-index: 20;
        --sky-sun-size: 150px;
      }

      sib-cloud.one {
        position: absolute;
        top: 15%;
        right: 5%;
        z-index: 40;
        --sky-cloud-size: 80px;
      }

      sib-cloud.two {
        position: absolute;
        top: 70%;
        left: 35%;
        z-index: 40;
      }

      paper-button {
        color: white;
      }

      .log-button {
        color: white;
        height: 100px;
        width: 100px;
        font-size: x-large;
      }

      .time {
        color: white;
        font-size: 5em;
      }
    </style>

    <app-localstorage-document log="" key="sib-prod" data="{{list}}">
    </app-localstorage-document>

    <div class="sky">
      <sib-sun></sib-sun>
      <sib-cloud class="one"></sib-cloud>
      <sib-cloud class="two"></sib-cloud>
    </div>

    <div class="layout vertical center">
      
      <div class="time" hidden$="[[todaysTime]]">
        [[time]]
      </div>
      <div class="time" hidden$="[[!todaysTime]]">
        [[todaysTime]]
      </div>

      <paper-icon-button icon="icons:alarm-on" class="log-button" on-tap="log">
      </paper-icon-button>
      
      <div>Last week:</div>      
      <div>09:40</div>
      <div>07:01</div>
      <div>10:30</div>
      <div>09:10</div>
      <div>09:15</div>
      <div>10:30</div>
      <div>09:10</div>
      <div>09:15</div>
      <div>09:40</div>
      <div>07:01</div>
      <div>10:30</div>
      <div>09:10</div>
      <div>09:15</div>
      <paper-button>More stats..</paper-button>
    </div>

  </template>

  <script>Polymer({is:"sib-app",properties:{list:{type:Array,value:[]},time:String,todaysTime:String,today:Object},observers:["onChange(list, list.splices, today)"],ready:function(){this.tick()},tick:function(){var t=this._getTime(new Date);(!this.time||t<this.time)&&(this.today=new Date),this.time=t,this.async(this.tick,1e3),this.onChange()},onChange:function(){var t=this._getLastDate();t&&this._isToday(t)?this.todaysTime=this._getTime(t):this.todaysTime=null},log:function(){var t={time:(new Date).toISOString()};this.push("list",t),console.log(t)},_getLastDate:function(){var t=this.list.slice(-1).pop();return t?new Date(t.time):null},_getTime:function(t){return t.toTimeString().split(" ")[0]},_isToday:function(t){var i=new Date;return i.toDateString()==t.toDateString()}});</script>
</dom-module>
</body></html>